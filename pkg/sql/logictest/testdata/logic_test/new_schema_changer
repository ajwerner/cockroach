# LogicTest: local-new-schema-changer

subtest add_column

statement ok
CREATE TABLE foo (i INT PRIMARY KEY)

statement ok
EXPLAIN (DDL) ALTER TABLE foo ADD COLUMN j INT

statement ok
EXPLAIN (DDL, DEPS) ALTER TABLE foo ADD COLUMN j INT

statement ok
ALTER TABLE foo ADD COLUMN j INT

statement ok
INSERT INTO foo VALUES (1, 1)

query II
SELECT * FROM foo
----
1  1

statement ok
DROP TABLE foo;

subtest add_column_default

statement ok
CREATE TABLE foo (i INT PRIMARY KEY)

statement ok
ALTER TABLE foo ADD COLUMN j INT DEFAULT 1

statement ok
INSERT INTO foo VALUES (1, 1)

statement ok
INSERT INTO foo(i) VALUES (2)

query II
SELECT * FROM foo
----
1  1
2  1

statement ok
DROP TABLE foo

subtest add_column_computed

statement ok
CREATE TABLE foo (i INT PRIMARY KEY)

statement ok
ALTER TABLE foo ADD COLUMN j INT AS (i+1) STORED

statement ok
INSERT INTO foo(i) VALUES (1)

query II
SELECT * FROM foo
----
1  2

statement ok
DROP TABLE foo

subtest add_column_families

statement ok
CREATE TABLE foo (i INT PRIMARY KEY)

statement ok
ALTER TABLE foo ADD COLUMN j INT CREATE FAMILY f2

statement ok
INSERT INTO foo VALUES (1, 2)

query II
SELECT * FROM foo
----
1  2

statement ok
DROP TABLE foo

subtest drop_column

statement ok
CREATE TABLE foo (i INT PRIMARY KEY, j INT)

statement ok
ALTER TABLE foo DROP COLUMN j

statement ok
INSERT INTO foo VALUES (1)

query I
SELECT * FROM foo
----
1

statement ok
DROP TABLE foo
